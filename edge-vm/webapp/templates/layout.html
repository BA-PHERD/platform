<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>BA-PHERD - {% block title %}{% endblock %}</title>
    <link rel="stylesheet" href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css">
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500">
    <script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>
    <script src="{{ url_for('static', filename='utils.js') }}"></script>
</head>

<body class="mdc-typography">
    <div class="mdc-dialog" id="login-dialog">
        <div class="mdc-dialog__container">
            <div class="mdc-dialog__surface" role="dialog" aria-modal="true" aria-labelledby="login-dialog"
                aria-describedby="login-dialog-content">
                <form action="www.google.it" method="post">
                    <h2 class="mdc-dialog__title" id="my-dialog-title">Login</h2>
                    <div class="mdc-dialog__content" id="my-dialog-content">
                        <ul class="mdc-list">
                            <li class="mdc-list-item" tabindex="0">
                                <label class="mdc-text-field mdc-text-field--filled">
                                    <span class="mdc-text-field__ripple"></span>
                                    <span class="mdc-floating-label" id="login-user-label">User</span>
                                    <input class="mdc-text-field__input" type="text"
                                        aria-labelledby="login-user-input" />
                                    <span class="mdc-line-ripple"></span>
                                </label>
                            </li>
                            <li class="mdc-list-item">
                                <label class="mdc-text-field mdc-text-field--filled">
                                    <span class="mdc-text-field__ripple"></span>
                                    <span class="mdc-floating-label" id="login-group-label">Group</span>
                                    <input class="mdc-text-field__input" type="text"
                                        aria-labelledby="login-group-input" />
                                    <span class="mdc-line-ripple"></span>
                                </label>
                            </li>
                        </ul>
                    </div>
                    <div class="mdc-dialog__actions">
                        <button type="button" class="mdc-button mdc-dialog__button" data-mdc-dialog-action="close">
                            <div class="mdc-button__ripple"></div>
                            <span class="mdc-button__label">Cancel</span>
                        </button>
                        <button type="button" class="mdc-button mdc-dialog__button" data-mdc-dialog-action="accept">
                            <div class="mdc-button__ripple"></div>
                            <span class="mdc-button__label">Login</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
        <div class="mdc-dialog__scrim"></div>
    </div>
    <!-- <div class="top-right-form">
        <form id="login-form" data-login-step="change">
            <label>
                Group Name<br>
                <input type="text" id="group-name" name="group_name" value="{{ group_name }}" readonly required
                    minlength="1">
            </label><br>
            <label>
                Username<br>
                <input type="text" id="username" name="username" value="{{ username }}" readonly required minlength="1">
            </label><br>
            <button type="submit" class="pretty-button" id="login-submit-btn">Modifica</button>
        </form>
        <div id="login-message" class="message"></div>
    </div> -->

    <aside class="mdc-drawer" id="side-nav-bar">
        <div class="mdc-drawer__content">
            <nav class="mdc-list">
                <a class="mdc-list-item" href="#">
                    <span class="mdc-list-item__ripple"></span>
                    <i class="material-icons mdc-list-item__graphic" aria-hidden="true">groups</i>
                    <span class="mdc-list-item__text">Pazienti</span>
                </a>
                <a class="mdc-list-item" href="#">
                    <span class="mdc-list-item__ripple"></span>
                    <i class="material-icons mdc-list-item__graphic" aria-hidden="true">biotech</i>
                    <span class="mdc-list-item__text">Risultati MiRNA</span>
                </a>
                <a class="mdc-list-item" href="#">
                    <span class="mdc-list-item__ripple"></span>
                    <i class="material-icons mdc-list-item__graphic" aria-hidden="true">construction</i>
                    <span class="mdc-list-item__text">Tasks</span>
                </a>
            </nav>
        </div>
    </aside>
    <div class="mdc-drawer-app-content mdc-theme--background page-container">
        <header class="mdc-top-app-bar mdc-top-app-bar--fixed" id="top-app-bar">
            <div class="mdc-top-app-bar__row">
                <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start">
                    <!-- <button class="material-icons mdc-top-app-bar__navigation-icon mdc-icon-button">menu</button> -->
                    <span class="mdc-top-app-bar__title">BA-PHERD</span>
                </section>
                <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-end" role="toolbar">
                    <button class="mdc-button">
                        <span class="mdc-button__ripple"></span>
                        <span class="mdc-button__label">Login</span>
                    </button>
                </section>
            </div>
        </header>
        <main class="main-content mdc-top-app-bar--fixed-adjust" id="main-content">
            <div class="mdc-top-app-bar--fixed-adjust">
                {% block main_content %}{% endblock %}
            </div>
        </main>
        <footer class="footer">
            <div class="mdc-layout-grid">
                <div class="mdc-layout-grid__inner">
                    <div class="mdc-layout-grid__cell">
                        <img src="{{ url_for('static', filename='logos/italiadomani.png') }}" class="footer-logo">
                    </div>
                    <div class="mdc-layout-grid__cell">
                        <img src="{{ url_for('static', filename='logos/MUR.png') }}" class="footer-logo">
                    </div>
                    <div class="mdc-layout-grid__cell">
                        <img src="{{ url_for('static', filename='logos/NextGenerationEU.png') }}" class="footer-logo">
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- <div class="container">
        {% block container_content %}{% endblock %}
    </div> -->

    {% block js %}{% endblock %}

    <script type="module">
        // **MATERIAL DESIGN**

        // login
        const loginDialog = new mdc.dialog.MDCDialog(document.querySelector('#login-dialog'));
        const loginDialogList = new mdc.list.MDCList(document.querySelector('#login-dialog .mdc-list'));

        loginDialog.listen('MDCDialog:opened', () => {
            loginDialogList.layout();
        });
        // const textField = new mdc.textField.MDCTextField(document.querySelector('.mdc-text-field:not(.mdc-dialog .mdc-list)'));

        // drawer
        const topAppBar = mdc.topAppBar.MDCTopAppBar.attachTo(document.getElementById('top-app-bar'));
        // const drawer = mdc.drawer.MDCDrawer.attachTo(document.querySelector('.mdc-drawer'));
        const drawerListElem = document.querySelector('#side-nav-bar .mdc-list')
        const drawerList = mdc.list.MDCList.attachTo(drawerListElem);
        document.querySelectorAll('.mdc-list-item').forEach(el => {
            new mdc.ripple.MDCRipple(el);
        });
        drawerList.wrapFocus = true;

        topAppBar.setScrollTarget(document.getElementById('main-content'));
        // topAppBar.listen('MDCTopAppBar:nav', () => {
        //     drawer.open = !drawer.open;
        // });

        const mainContent = document.querySelector('.main-content');
        drawerListElem.addEventListener('click', (event) => {
            mainContent.querySelector('input, button, a').focus();
        });

        // buttons
        // const buttonRipple = new mdc.ripple.MDCRipple(document.querySelectorAll('.mdc-button'));
    </script>

    <!-- <script>
        const group = document.getElementById('group-name');
        const user = document.getElementById('username');
        const loginMessage = document.getElementById('login-message');
        const loginSubmitBtn = document.getElementById('login-submit-btn');
        const loginForm = document.getElementById('login-form');
        loginForm.addEventListener('submit', function (e) {
            e.preventDefault();
            if (loginForm.dataset.loginStep === 'change') {
                group.readOnly = false;
                user.readOnly = false;
                loginSubmitBtn.textContent = 'Login'
                loginForm.dataset.loginStep = 'login';

                return;
            }

            loginSubmitBtn.disabled = true;
            group.readOnly = true;
            user.readOnly = true;
            loginSubmitBtn.textContent = 'Modifica'
            loginForm.dataset.loginStep = 'change';

            fetch("{{ url_for('users.login_user') }}", {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ group_name: group.value, username: user.value })
            })
                .then(res => {
                    console.log(res);

                    if (res.ok) {
                        showMsg(loginMessage, `Login con utente ${group.value}:${user.value}`, 'success');
                    }
                    else {
                        throw new Error(`The response returned status ${res.status}`);
                    }
                })
                .catch(err => {
                    showMsg(loginMessage, 'Si è verificato un errore', 'error');
                    console.error(err);
                })
                .then(_ => {
                    loginSubmitBtn.disabled = false;
                });
        });
    </script> -->
</body>

</html>